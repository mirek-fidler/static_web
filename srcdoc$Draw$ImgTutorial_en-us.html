<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML lang="en-us">
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="U++ HTML Package">
<META NAME="Description" CONTENT="In U++, predefined Images needed for application (e.g. as tool bar icons) are usually designed using TheIDE's Image designer.">
<TITLE>Image Tutorial :: U++</TITLE>
<STYLE TYPE="text/css"><!--
.A{margin:0px 0px 0px 0px;text-indent:0px;text-align:left;color:#000000;font-family:sans-serif;font-size:10pt;font-weight:normal;font-style:normal;}
.B{font-size:12pt;}
.C{margin:0px 0px 16px 0px;text-indent:0px;text-align:left;color:#000000;font-family:serif;font-size:24pt;font-weight:bold;font-style:normal;}
.D{margin:16px 0px 0px 0px;text-indent:0px;text-align:left;color:#000000;font-family:sans-serif;font-size:16pt;font-weight:bold;font-style:normal;}
.E{margin:8px 0px 8px 0px;text-indent:0px;text-align:left;color:#000000;font-family:sans-serif;font-size:10pt;font-weight:normal;font-style:normal;line-height:150%}
.F{margin:0px 0px 0px 0px;text-indent:0px;text-align:center;color:#000000;font-family:sans-serif;font-size:10pt;font-weight:normal;font-style:normal;}
.G{font-style:italic;}
.H{margin:0px 0px 0px 64px;text-indent:0px;text-align:left;color:#0000ff;font-family:monospace;font-size:9pt;font-weight:normal;font-style:normal;}
.I{color:#8000ff;}
.J{color:#000000;}
.K{margin:0px 0px 0px 64px;text-indent:0px;text-align:left;color:#000000;font-family:monospace;font-size:9pt;font-weight:normal;font-style:normal;}
.L{color:#0000ff;font-weight:bold;}
.M{margin:0px 0px 0px 64px;text-indent:0px;text-align:left;color:#000000;font-family:monospace;font-size:9pt;font-weight:bold;font-style:normal;}
.N{margin:0px 0px 0px 64px;text-indent:0px;text-align:left;color:#0000ff;font-family:monospace;font-size:9pt;font-weight:bold;font-style:normal;}
.O{color:#0000ff;}
.P{color:#800000;}
.Q{font-weight:bold;}
.R{color:#008080;}
.S{color:#800000;font-weight:bold;}
.T{display:list-item;list-style-type:disc;margin:8px 0px 8px 58px;text-indent:0px;text-align:left;color:#000000;font-family:sans-serif;font-size:10pt;font-weight:normal;font-style:normal;line-height:150%}
.U{color:#8000ff;font-weight:bold;}
.V{font-weight:normal;}
.W{display:list-item;list-style-type:disc;margin:8px 0px 8px 52px;text-indent:0px;text-align:left;color:#000000;font-family:sans-serif;font-size:10pt;font-weight:normal;font-style:normal;line-height:150%}
a.l1         { text-decoration:none; font-size: 8pt; font-family: sans-serif; font-weight: normal; }
a.l1:link    { color:#000000; }
a.l1:visited { color:#000080; }
a.l1:hover   { color:#9933CC; }
a.l1:active  { color:#000000; }
a.l2         { text-decoration:none; font-size: 12pt; font-family: sans-serif; font-variant: small-caps; }
a.l2:link    { color:#0066FF; }
a.l2:visited { color:#FF6600; }
a.l2:hover   { color:#BC0624; }
a.l2:active  { color:#BC0024; }

-->
</STYLE>
<META NAME="keywords" CONTENT="framework, toolkit, widget, c++, visual, studio, dev-cpp, builder, ide, class, component,wxwidgets, qt, rapid, application, development, rad, mfc, linux, macos, gui, sdl, directx, desktop"><META name="robots" content="index,follow">
<LINK rel="alternate" type="application/rss+xml" title="SVN changes" href="svnchanges.xml">
<LINK rel="shortcut icon" type="image/png" href="favicon.png">
</HEAD><BODY BGCOLOR="#D2D9D2" ALINK="#800000" LINK="#000000" VLINK="#000080"><TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0" WIDTH="100%"><TR><TD COLSPAN="3"><TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0" WIDTH="100%" BGCOLOR="#FFFFFF" style="border: 1px solid #6E89AE;padding-left: 10px;padding-right: 0px;padding-top: 0px;padding-bottom: 0px;"><TR><TD><A HREF="index.html"><IMG SRC="0i.png" ALT="" BORDER="0"></A>
</TD>
<TD ALIGN="RIGHT" VALIGN="BOTTOM" STYLE="padding-bottom: 5px; background-image: url('1i.png')"><span style="font-size: 14pt; font-family: sans-serif;"><script type="text/javascript"><!--
google_ad_client = "pub-1082147624384270";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_text = "000000";
google_color_url = "008000";
//--></script>
<script type="text/javascript"
  src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
&nbsp;&nbsp;</span>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0" WIDTH="100%"><TR><TD COLSPAN="3" BGCOLOR="#D2D9D2" HEIGHT="6"></TD>
</TR>
<TR><TD VALIGN="TOP" ALIGN="CENTER"><TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0" WIDTH="160"><TR><TD ALIGN="CENTER"><TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0" WIDTH="100%" BGCOLOR="#FFFFFF" style="border-style: solid; border-width: 1px; border-color: #6E89AE;padding: 0px"><TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px;"><A HREF="www$uppweb$overview$en-us.html" CLASS="l1">Overview</A>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px; border-top: 1px solid #6E89AE;"><A HREF="www$uppweb$examples$en-us.html" CLASS="l1">Examples</A>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px; border-top: 1px solid #6E89AE;"><A HREF="www$uppweb$ss$en-us.html" CLASS="l1">Screenshots</A>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px; border-top: 1px solid #6E89AE;"><A HREF="www$uppweb$comparison$en-us.html" CLASS="l1">Comparisons</A>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px; border-top: 1px solid #6E89AE;"><A HREF="www$uppweb$apps$en-us.html" CLASS="l1">Applications</A>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px; border-top: 1px solid #6E89AE;"><A HREF="www$uppweb$download$en-us.html" CLASS="l1">Download</A>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px; border-top: 1px solid #6E89AE;"><A HREF="www$uppweb$documentation$en-us.html" CLASS="l1">Documentation</A>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px; border-top: 1px solid #6E89AE;"><A HREF="www$uppweb$Tutorials$en-us.html" CLASS="l1">Tutorials</A>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px; border-top: 1px solid #6E89AE;"><A HREF="app$ide$UppHub$en-us.html" CLASS="l1">UppHub</A>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px; border-top: 1px solid #6E89AE;"><A HREF="www$uppweb$Roadmap$en-us.html" CLASS="l1">Status & Roadmap</A>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px; border-top: 1px solid #6E89AE;"><A HREF="www$uppweb$FAQ$en-us.html" CLASS="l1">FAQ</A>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px; border-top: 1px solid #6E89AE;"><A HREF="app$ide$About$en-us.html" CLASS="l1">Authors & License</A>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px; border-top: 1px solid #6E89AE;"><A HREF="https://www.ultimatepp.org/forums" CLASS="l1">Forums</A>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:12px; padding-right:0px; padding-top:6px; padding-bottom:6px; border-top: 1px solid #6E89AE;"><A HREF="www$uppweb$Funding$en-us.html" CLASS="l1">Funding U++</A>
</TD>
</TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%"><TR><TD></TD>
</TR>
</TABLE>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0" WIDTH="100%" BGCOLOR="#FFFFFF" style="border-style: solid; border-width: 1px; border-color: #6E89AE;padding: 0px"><TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('3i.png'); border: 0px solid black;padding-left:12px; padding-right:0px; padding-top:1px; padding-bottom:1px;color:#FFFFFF;"><B><span style="font-size: 8pt; font-family: sans-serif;">Search on this site</span>
</B>
</TD>
</TR>
<TR><TD WIDTH="100%" VALIGN="MIDDLE" STYLE="background-image: url('2i.png'); border: 0px solid black; padding-left:6px; padding-right:0px; padding-top:4px; padding-bottom:4px;border-top: 1px solid #6E89AE;"><TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0" WIDTH="100%"><TR><TD><IMG SRC="4i.png" ALT="" BORDER="0"></TD>
<TD><FORM ACTION="https://www.google.com/search" METHOD="GET" STYLE="margin:0px;padding:0px;"><INPUT TYPE="HIDDEN" NAME="ie" VALUE="UTF-8"><INPUT TYPE="HIDDEN" NAME="oe" VALUE="UTF-8"><INPUT TYPE="TEXT" NAME="q" SIZE="15" MAXLENGTH="256" placeholder="Site search"><INPUT TYPE="HIDDEN" NAME="sitesearch" VALUE="ultimatepp.org"></FORM>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%"><TR><TD></TD>
</TR>
</TABLE>
<br><div id="fb-root"></div>
<script type="text/javascript">(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div class="fb-like" data-href="https://www.facebook.com/pages/Upp-Framework/262346610476027?sk=wall" data-send="false" data-layout="button_count" data-width="160" data-show-faces="false" data-font="arial"></div>
<br><br><script type="text/javascript"><!--
google_ad_client = "pub-1082147624384270";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_text = "000000";
google_color_url = "008000";
//--></script>
<script type="text/javascript"
  src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script><br><br><script type="text/javascript"><!--
google_ad_client = "pub-1082147624384270";
google_ad_width = 160;
google_ad_height = 90;
google_ad_format = "160x90_0ads_al_s";
google_ad_channel = "";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_text = "000000";
google_color_url = "008000";
//--></script>
<script type="text/javascript"
  src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<br><br><br><br><br><br><A HREF="https://sourceforge.net/projects/upp/"><IMG SRC="https://sourceforge.net/sflogo.php?group_id=93970&amp;type=2" ALT="SourceForge.net Logo" BORDER="0" WIDTH="125" HEIGHT="37"></A>
<br><br><A HREF="https://flathub.org/en/apps/org.ultimatepp.TheIDE"><IMG SRC="5i.png" ALT="SourceForge.net Logo" BORDER="0" WIDTH="125" HEIGHT="37"></A>
<br><br><div style="background-color:#ffffff;width:125;height:35"><A HREF="https://github.com/ultimatepp"><IMG SRC="6i.png" ALT="GitHub Logo" BORDER="0" WIDTH="125" HEIGHT="35"></A>
</div><br><div style="background-color:#ffffff;width:125;height:35"><div style="height:5"></div><A HREF="https://discord.gg/8XzqQzXZzb"><IMG SRC="https://assets-global.website-files.com/6257adef93867e50d84d30e2/636e0b5061df29d55a92d945_full_logo_blurple_RGB.svg" ALT="Discord Logo" BORDER="0" WIDTH="125" HEIGHT="25"></A>
</div><br></TD>
</TR>
</TABLE>
</TD>
<TD VALIGN="TOP" BGCOLOR="#D2D9D2"><TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0" WIDTH="6"><TR><TD></TD>
</TR>
</TABLE>
</TD>
<TD VALIGN="TOP" WIDTH="100%" BGCOLOR="#D2D9D2"><TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0" BGCOLOR="#FFFFFF" WIDTH="100%" style="border-style: solid; border-width: 1px; border-color: #6E89AE;padding: 10px;;"><TR><TD><TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0" WIDTH="100%"><TR><TD><p class="C">Image tutorial</p>
<hr><p class="D">Table of contents</p>
<p class="A">&nbsp;</p>
<p class="A"><a href="srcdoc$Draw$ImgTutorial$en-us.html#1">1. Image designer and painting the image</a></p>
<p class="A"><a href="srcdoc$Draw$ImgTutorial$en-us.html#2">2. Image list classes as arrays</a></p>
<p class="A"><a href="srcdoc$Draw$ImgTutorial$en-us.html#3">3. Creating and altering images in the code using ImageBuffer</a></p>
<p class="A"><a href="srcdoc$Draw$ImgTutorial$en-us.html#4">4. Loading Images from file</a></p>
<p class="A"><a href="srcdoc$Draw$ImgTutorial$en-us.html#5">5. Processing raster images by scanlines</a></p>
<p class="A"><a href="srcdoc$Draw$ImgTutorial$en-us.html#6">6. Image cache</a></p>
<p class="A">&nbsp;</p>
<hr><p id="1" class="D">1. Image designer and painting the image</p>
<p class="E">In U++, predefined Images needed for application (e.g. as tool bar icons) are usually designed using TheIDE's Image designer.</p>
<p class="E">&nbsp;</p>
<p class="F"><a href="srcdoc$Draw$ImgTutorial_en-us.html_0.png"><img src="srcdoc$Draw$ImgTutorial_en-us.html_0.png" border="0" alt="" style="width: 639px; height: 373px"></a></p>
<p class="E">&nbsp;</p>
<p class="E">Image designer stores images in .iml files, which are then included using one of iml headers into C++ and compiled into the application. Such images are in the code represented as static methods of class representing the single .iml file (<span class="G">image list class)</span>.</p>
<p class="E">&nbsp;</p>
<p class="H"><span class="I">#include</span><span class="J"> </span>&lt;<span class="J">CtrlLib</span>/<span class="J">CtrlLib</span>.<span class="J">h</span>&gt;</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">using</span> <span class="L">namespace</span> Upp;</p>
<p class="K">&nbsp;</p>
<p class="M"><span class="I"><u>#define</u></span><u> IMAGECLASS MyImages</u></p>
<p class="N"><span class="I"><u>#define</u></span><span class="J"><u> IMAGEFILE &nbsp;</u></span><u>&lt;</u><span class="J"><u>Image01</u></span><u>/</u><span class="J"><u>images</u></span><u>.</u><span class="J"><u>iml</u></span><u>&gt;</u></p>
<p class="N"><span class="I"><u>#include</u></span><span class="J"><u> </u></span><u>&lt;</u><span class="J"><u>Draw</u></span><u>/</u><span class="J"><u>iml</u></span><u>.</u><span class="J"><u>h</u></span><u>&gt;</u></p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">struct</span> MyApp <span class="O">:</span> TopWindow {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyApp() {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">const</span> <span class="L">auto</span> isz <span class="O">=</span> MyImages<span class="O">::</span>MyImage()<span class="O">.</span>GetSize();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetRect(<span class="P">0</span>, <span class="P">0</span>, <span class="P">100</span> <span class="O">+</span> isz<span class="O">.</span>cx, <span class="P">100</span> <span class="O">+</span> isz<span class="O">.</span>cy);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">void</span> Paint(Draw<span class="O">&amp;</span> w) <span class="L">override</span> {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawRect(GetSize(), SColorFace());</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span><span class="Q"><u>DrawImage</u></span>(<span class="P">50</span>, <span class="P">50</span>, <span class="Q"><u>MyImages</u></span><span class="L"><u>::</u></span><span class="Q"><u>MyImage()</u></span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K">};</p>
<p class="K">&nbsp;</p>
<p class="K">GUI_APP_MAIN</p>
<p class="K">{</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyApp()<span class="O">.</span>Run();</p>
<p class="K">}</p>
<p class="E">&nbsp;</p>
<p class="F"><a href="srcdoc$Draw$ImgTutorial_en-us.html_1.png"><img src="srcdoc$Draw$ImgTutorial_en-us.html_1.png" border="0" alt="" style="width: 122px; height: 153px"></a></p>
<p class="E">&nbsp;</p>
<hr><p id="2" class="D">2. Image list classes as arrays</p>
<p class="E">You can also access images of image list class as an array and even change them:</p>
<p class="E">&nbsp;</p>
<p class="F"><a href="srcdoc$Draw$ImgTutorial_en-us.html_2.png"><img src="srcdoc$Draw$ImgTutorial_en-us.html_2.png" border="0" alt="" style="width: 202px; height: 113px"></a></p>
<p class="E">&nbsp;</p>
<p class="H"><span class="I">#include</span><span class="J"> </span>&lt;<span class="J">CtrlLib</span>/<span class="J">CtrlLib</span>.<span class="J">h</span>&gt;</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">using</span> <span class="L">namespace</span> Upp;</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="I">#define</span> IMAGECLASS MyImages</p>
<p class="H"><span class="I">#define</span><span class="J"> IMAGEFILE &nbsp;</span>&lt;<span class="J">Image02a</span>/<span class="J">images</span>.<span class="J">iml</span>&gt;</p>
<p class="H"><span class="I">#include</span><span class="J"> </span>&lt;<span class="J">Draw</span>/<span class="J">iml</span>.<span class="J">h</span>&gt;</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">struct</span> MyApp <span class="O">:</span> TopWindow {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyApp() {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetRect(<span class="P">0</span>, <span class="P">0</span>, <span class="P">170</span>, <span class="P">170</span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">void</span> Paint(Draw<span class="O">&amp;</span> w) <span class="L">override</span> {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawRect(GetSize(), SColorPaper());</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">for</span>(<span class="L">int</span> i <span class="O">=</span> <span class="P">0</span>; i <span class="O">&lt;</span> MyImages<span class="O">::</span><span class="Q"><u>GetCount</u></span>(); i<span class="O">++</span>) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawImage(<span class="P">50</span>, <span class="P">80</span> <span class="O">+</span> <span class="P">20</span> <span class="O">*</span> i, MyImages<span class="O">::</span><span class="Q"><u>Get</u></span>(i));</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawText(<span class="P">80</span>, <span class="P">80</span> <span class="O">+</span> <span class="P">20</span> <span class="O">*</span> i, MyImages<span class="O">::</span><span class="Q"><u>GetId</u></span>(i));</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawImage(<span class="P">20</span>, <span class="P">0</span>, <span class="P">50</span>, <span class="P">50</span>, MyImages<span class="O">::</span>Get(MyImages<span class="O">::</span><span class="Q"><u>I_Circle</u></span>));</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawText(<span class="P">80</span>, <span class="P">0</span>, AsString(MyImages<span class="O">::</span><span class="Q"><u>Find</u></span>(<span class="P">&quot;Circle&quot;</span>)));</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K">};</p>
<p class="K">&nbsp;</p>
<p class="K">GUI_APP_MAIN</p>
<p class="K">{</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyApp()<span class="O">.</span>Run();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;Image m <span class="O">=</span> MyImages<span class="O">::</span>Circle();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyImages<span class="O">::</span><span class="Q"><u>Set</u></span>(MyImages<span class="O">::</span>I_Circle, MyImages<span class="O">::</span>Triangle());</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyImages<span class="O">::</span><span class="Q"><u>Set</u></span>(MyImages<span class="O">::</span>I_Triangle, m);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyApp()<span class="O">.</span>Run();</p>
<p class="K">}</p>
<p class="E">&nbsp;</p>
<p class="F"><a href="srcdoc$Draw$ImgTutorial_en-us.html_3.png"><img src="srcdoc$Draw$ImgTutorial_en-us.html_3.png" border="0" alt="" style="width: 157px; height: 184px"></a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="srcdoc$Draw$ImgTutorial_en-us.html_4.png"><img src="srcdoc$Draw$ImgTutorial_en-us.html_4.png" border="0" alt="" style="width: 160px; height: 183px"></a></p>
<p class="E">&nbsp;</p>
<p class="E">Index constants representing individual Images in .iml file are based on the name as defined in image designer, placed in image list class scope and prefixed with I_ (like I_Circle in the above example).</p>
<p class="E">Image list classes also provide unified interface class to its content: <span class="Q">Iml</span>. In fact, method used in previous example are just wrappers that call Iml methods:</p>
<p class="E">&nbsp;</p>
<p class="H"><span class="I">#include</span><span class="J"> </span>&lt;<span class="J">CtrlLib</span>/<span class="J">CtrlLib</span>.<span class="J">h</span>&gt;</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">using</span> <span class="L">namespace</span> Upp;</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="I">#define</span> IMAGECLASS MyImages</p>
<p class="H"><span class="I">#define</span><span class="J"> IMAGEFILE &nbsp;</span>&lt;<span class="J">Image02b</span>/<span class="J">images</span>.<span class="J">iml</span>&gt;</p>
<p class="H"><span class="I">#include</span><span class="J"> </span>&lt;<span class="J">Draw</span>/<span class="J">iml</span>.<span class="J">h</span>&gt;</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">class</span> MyApp <span class="O">:</span> <span class="L">public</span> TopWindow {</p>
<p class="H"><span class="Q">public</span>:</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyApp(<span class="Q"><u>Iml</u></span><span class="L"><u>&amp;</u></span><span class="Q"><u> iml</u></span>) <span class="O">:</span> <span class="Q"><u>m_iml(iml)</u></span> {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetRect(<span class="P">0</span>, <span class="P">0</span>, <span class="P">200</span>, <span class="P">200</span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">void</span> Paint(Draw<span class="O">&amp;</span> w) <span class="L">override</span> {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawRect(GetSize(), SColorPaper());</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">for</span>(<span class="L">int</span> i <span class="O">=</span> <span class="P">0</span>; i <span class="O">&lt;</span> m_iml<span class="O">.</span><span class="Q"><u>GetCount</u></span>(); i<span class="O">++</span>) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawImage(<span class="P">50</span>, <span class="P">80</span> <span class="O">+</span> <span class="P">20</span> <span class="O">*</span> i, m_iml<span class="O">.</span><span class="Q"><u>Get</u></span>(i));</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawText(<span class="P">80</span>, <span class="P">80</span> <span class="O">+</span> <span class="P">20</span> <span class="O">*</span> i, m_iml<span class="O">.</span><span class="Q"><u>GetId</u></span>(i));</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;</p>
<p class="H"><span class="Q">private</span>:</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="Q"><u>Iml</u></span><span class="L"><u>&amp;</u></span><span class="Q"><u> m_iml</u></span>;</p>
<p class="K">};</p>
<p class="K">&nbsp;</p>
<p class="K">GUI_APP_MAIN</p>
<p class="K">{</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyApp(MyImages<span class="O">::</span><span class="Q"><u>Iml</u></span>())<span class="O">.</span>Run();</p>
<p class="K">}</p>
<p class="E">&nbsp;</p>
<p class="F"><a href="srcdoc$Draw$ImgTutorial_en-us.html_5.png"><img src="srcdoc$Draw$ImgTutorial_en-us.html_5.png" border="0" alt="" style="width: 200px; height: 239px"></a></p>
<p class="E">&nbsp;</p>
<hr><p id="3" class="D">3. Creating and altering images in the code using ImageBuffer</p>
<p class="E">ImageBuffer represent a write access to the immutable Image value.</p>
<p class="E">&nbsp;</p>
<p class="H"><span class="I">#include</span><span class="J"> </span>&lt;<span class="J">CtrlLib</span>/<span class="J">CtrlLib</span>.<span class="J">h</span>&gt;</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">using</span> <span class="L">namespace</span> Upp;</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">struct</span> MyApp <span class="O">:</span> <span class="L">public</span> TopWindow {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;Image img;</p>
<p class="K">&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyApp() {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Q"><u>ImageBuffer</u></span> ib(<span class="P">50</span>, <span class="P">50</span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">for</span>(<span class="L">int</span> y <span class="O">=</span> <span class="P">0</span>; y <span class="O">&lt;</span> <span class="P">50</span>; y<span class="O">++</span>) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Q"><u>RGBA</u></span> <span class="O">*</span>l <span class="O">=</span> ib<span class="O">[</span>y<span class="O">]</span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">for</span>(<span class="L">int</span> x <span class="O">=</span> <span class="P">0</span>; x <span class="O">&lt;</span> <span class="P">50</span>; x<span class="O">++</span>) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">if</span>(y <span class="O">==</span> <span class="P">0</span> <span class="O">||</span> y <span class="O">==</span> <span class="P">49</span> <span class="O">||</span> x <span class="O">==</span> <span class="P">0</span> <span class="O">||</span> x <span class="O">==</span> <span class="P">49</span>) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="O">*</span>l<span class="O">++</span> <span class="O">=</span> Black();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">else</span> {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l<span class="O">-&gt;</span>a <span class="O">=</span> <span class="P">2</span> <span class="O">*</span> (x <span class="O">+</span> y);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l<span class="O">-&gt;</span>r <span class="O">=</span> <span class="P">4</span> <span class="O">*</span> x;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l<span class="O">-&gt;</span>g <span class="O">=</span> <span class="P">4</span> <span class="O">*</span> y;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l<span class="O">-&gt;</span>b <span class="O">=</span> <span class="P">200</span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l<span class="O">++</span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Q"><u>Premultiply</u></span>(ib);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img <span class="O">=</span> ib;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetRect(<span class="P">0</span>, <span class="P">0</span>, img<span class="O">.</span>GetSize()<span class="O">.</span>cx <span class="O">+</span> <span class="P">50</span>, img<span class="O">.</span>GetSize()<span class="O">.</span>cy <span class="O">+</span> <span class="P">35</span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K">&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">void</span> Paint(Draw<span class="O">&amp;</span> w) <span class="L">override</span> {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawRect(GetSize(), White);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawImage(<span class="P">10</span>, <span class="P">5</span>, img);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawImage(<span class="P">40</span>, <span class="P">25</span>, img);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">void</span> LeftDown(Point p, <span class="R">dword</span> keyflags) <span class="L">override</span> {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Q"><u>ImageBuffer</u></span> ib(img);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">for</span>(<span class="L">int</span> y <span class="O">=</span> <span class="P">15</span>; y <span class="O">&lt;</span> <span class="P">35</span>; y<span class="O">++</span>) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RGBA <span class="O">*</span>l <span class="O">=</span> ib<span class="O">[</span>y<span class="O">]</span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">for</span>(<span class="L">int</span> x <span class="O">=</span> <span class="P">15</span>; x <span class="O">&lt;</span> <span class="P">35</span>; x<span class="O">++</span>) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l<span class="O">[</span>x<span class="O">]</span> <span class="O">=</span> <span class="S"><u>100</u></span><span class="Q"><u> </u></span><span class="L"><u>*</u></span><span class="Q"><u> Red()</u></span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Q"><u>img </u></span><span class="L"><u>=</u></span><span class="Q"><u> ib</u></span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Refresh();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K">};</p>
<p class="K">&nbsp;</p>
<p class="K">GUI_APP_MAIN</p>
<p class="K">{</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyApp()<span class="O">.</span>Run();</p>
<p class="K">}</p>
<p class="E">&nbsp;</p>
<p class="F"><a href="srcdoc$Draw$ImgTutorial_en-us.html_6.png"><img src="srcdoc$Draw$ImgTutorial_en-us.html_6.png" border="0" alt="" style="width: 117px; height: 126px"></a> &nbsp;&nbsp;<a href="srcdoc$Draw$ImgTutorial_en-us.html_7.png"><img src="srcdoc$Draw$ImgTutorial_en-us.html_7.png" border="0" alt="" style="width: 117px; height: 126px"></a></p>
<p class="E">&nbsp;</p>
<p class="E">To create a new image, create <span class="Q">ImageBuffer</span> of required size and simply set <span class="Q">RGBA</span> pixels of the image. ImageBuffer provides operator[] returning the pointer to scanlines. When created, assign ImageBuffer instance to Image. Note that this operation clears the ImageBuffer (for performance reasons).</p>
<p class="E">Ultimate++ expects pixel data to be in premultiplied alpha format - <span class="Q">Premultiply</span> can do that for the whole ImageBuffer (or Image) in straight format.</p>
<p class="E">To alter existing Image, assign it to ImageBuffer, alter pixels and assign back to the Image. Assigning Image to ImageBuffer clears the Image (again, for performance reasons). In this case, operator* is used to combine alpha value 100 with the Red color, resulting in correctly premultiplied RGBA pixel.</p>
<p class="A">&nbsp;</p>
<hr><p id="4" class="D">4. Loading Images from file</p>
<p class="E">All of internal processing of raster image data in U++ is performed using the straightforward RGBA 4x8-bit format. In order to process other image format there are <span class="Q">Raster</span> and <span class="Q">RasterEncoder</span> based classes. Raster represents &quot;input&quot; Image, RasterEncoder &quot;output&quot;. Images are processed in scan-lines.</p>
<p class="E">Individual raster formats like BMP or GIF are processed by classes derived from <span class="Q">StreamRaster</span>. StreamRaster provides the static interface to register various readers; reads are able to detect whether a given stream is in appropriate format. StreamRaster then contains static methods like &nbsp;&quot;LoadFileAny&quot; which detects the format of an image file and loads it using the appropriate StreamRaster class.</p>
<p class="E">&nbsp;</p>
<p class="H"><span class="I">#include</span><span class="J"> </span>&lt;<span class="J">CtrlLib</span>/<span class="J">CtrlLib</span>.<span class="J">h</span>&gt;</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">using</span> <span class="L">namespace</span> Upp;</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">struct</span> MyApp <span class="O">:</span> <span class="L">public</span> TopWindow {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;Image &nbsp;&nbsp;img;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;FileSel fs;</p>
<p class="K">&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyApp() {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fs<span class="O">.</span>Type(<span class="P">&quot;Image file&quot;</span>, <span class="P">&quot;*.bmp;*.png;*.tif;*.tiff;*.jpg;*.jpeg;*.gif&quot;</span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sizeable();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K">&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">void</span> Paint(Draw<span class="O">&amp;</span> w) <span class="L">override</span> {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawRect(GetSize(), White);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">if</span>(img) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawImage(<span class="P">0</span>, <span class="P">0</span>, img);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">else</span> {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawText(<span class="P">0</span>, <span class="P">0</span>, <span class="P">&quot;No image loaded!&quot;</span>, Arial(<span class="P">30</span>)<span class="O">.</span>Italic());</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">void</span> LeftDown(Point, <span class="R">dword</span>) <span class="L">override</span> {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Open();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">void</span> Open() {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">if</span>(fs<span class="O">.</span>ExecuteOpen(<span class="P">&quot;Choose the image file to open&quot;</span>)) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img <span class="O">=</span> <span class="Q"><u>StreamRaster</u></span><span class="L"><u>::</u></span><span class="Q"><u>LoadFileAny</u></span>(<span class="O">~</span>fs);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Refresh();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K">};</p>
<p class="K">&nbsp;</p>
<p class="K">GUI_APP_MAIN</p>
<p class="K">{</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyApp app;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;app<span class="O">.</span>Open();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;app<span class="O">.</span>Run();</p>
<p class="K">}</p>
<p class="E">&nbsp;</p>
<p class="E">Important thing to note is that while packages dealing with specific formats self-register for use with <span class="Q">LoadFileAny</span>, you need to <span class="Q">add specific packages</span> dealing with format to TheIDE project:</p>
<p class="T"> <span class="Q">plugin/bmp</span> - for BMP file format support</p>
<p class="T"><span class="Q">plugin/png</span> - for PNG file format support</p>
<p class="T"><span class="Q">plugin/jpg</span> - for JPEG file format support</p>
<p class="T"><span class="Q">plugin/tif </span>- for TIFF file format support</p>
<p class="T"><span class="Q">plugin/gif</span> - for GIF file format support</p>
<p class="E">&nbsp;</p>
<hr><p id="5" class="D">5. Processing raster images by scanlines</p>
<p class="E">Sometimes it is important to process images without loading all the RGBA data into the memory. In such case Raster and <span class="Q">RasterEncoder</span> provide interface to process them by scanlines. This example converts an image to grayscale (by using just G channel) and saves it as low-quality JPG image:</p>
<p class="E">&nbsp;</p>
<p class="H"><span class="I">#include</span><span class="J"> </span>&lt;<span class="J">CtrlLib</span>/<span class="J">CtrlLib</span>.<span class="J">h</span>&gt;</p>
<p class="H"><span class="I">#include</span><span class="J"> </span>&lt;<span class="J">plugin</span>/<span class="J">jpg</span>/<span class="J">jpg</span>.<span class="J">h</span>&gt;</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">using</span> <span class="L">namespace</span> Upp;</p>
<p class="K">&nbsp;</p>
<p class="K">GUI_APP_MAIN</p>
<p class="K">{</p>
<p class="K"> &nbsp;&nbsp;&nbsp;FileSel fs;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;fs<span class="O">.</span>Type(<span class="P">&quot;Image file&quot;</span>, <span class="P">&quot;*.bmp;*.png;*.tif;*.tiff;*.jpg;*.jpeg;*.gif&quot;</span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">if</span>(<span class="O">!</span>fs<span class="O">.</span>ExecuteOpen(<span class="P">&quot;Choose the image file to convert&quot;</span>))</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="U"><u>return</u></span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;String fn <span class="O">=</span> <span class="O">~</span>fs;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="Q"><u>JPGEncoder</u></span> jpg(<span class="P">20</span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;FileIn in(fn);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="Q"><u>One</u></span><span class="L"><u>&lt;</u></span><span class="Q"><u>StreamRaster</u></span><span class="L"><u>&gt;</u></span><span class="Q"><u> raster </u></span><span class="L"><u>=</u></span><span class="Q"><u> StreamRaster</u></span><span class="L"><u>::</u></span><span class="Q"><u>OpenAny(in)</u></span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">if</span>(<span class="O">!</span>raster) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exclamation(<span class="P">&quot;Invalid input&quot;</span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="U"><u>return</u></span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;FileOut out(fn <span class="O">+</span> <span class="P">&quot;.out.png&quot;</span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;jpg<span class="O">.</span><span class="Q"><u>SetStream(out)</u></span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;jpg<span class="O">.</span><span class="Q"><u>Create(raster</u></span><span class="L"><u>-&gt;</u></span><span class="Q"><u>GetSize())</u></span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">for</span>(<span class="L">int</span> i <span class="O">=</span> <span class="P">0</span>; i <span class="O">&lt;</span> raster<span class="O">-&gt;</span><span class="Q"><u>GetHeight</u></span>(); i<span class="O">++</span>) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Q"><u>RasterLine</u></span> l <span class="O">=</span> raster<span class="O">-&gt;</span><span class="Q"><u>GetLine</u></span>(i);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Buffer<span class="O">&lt;</span>RGBA<span class="O">&gt;</span> out(raster<span class="O">-&gt;</span><span class="Q"><u>GetWidth</u></span>());</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">for</span>(<span class="L">int</span> j <span class="O">=</span> <span class="P">0</span>; j <span class="O">&lt;</span> raster<span class="O">-&gt;</span><span class="Q"><u>GetWidth</u></span>(); j<span class="O">++</span>) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out<span class="O">[</span>j<span class="O">].</span>g <span class="O">=</span> out<span class="O">[</span>j<span class="O">].</span>b <span class="O">=</span> out<span class="O">[</span>j<span class="O">].</span>r <span class="O">=</span> l<span class="O">[</span>j<span class="O">].</span>g;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out<span class="O">[</span>j<span class="O">].</span>a <span class="O">=</span> <span class="P">255</span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jpg<span class="O">.</span>WriteLine(out);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K">}</p>
<p class="E">&nbsp;</p>
<p class="E"><span class="Q">StreamRaster::OpenAny</span> returns a StreamRaster derived class capable of reading the input stream (or empty One if the format is not recognized).</p>
<p class="E"><span class="Q">RasterLine </span>provides the information of single line of Raster. It also hides the differences between referencing the data in the memory (as ImageRaster provides the Raster interface for regular Image) and using buffer to load the scan-line from the input stream (file). </p>
<p class="E"><span class="Q">GetLine </span>returns required line from the Raster. Note that not while GetLine provides &quot;random&quot; access to the Raster, not every Raster provides fast seeks back. E.g. It is therefore advisable to avoid seeking back if possible. E.g. plugin/jpg restarts the reading of file when seek back is requested, that can be painfully slow.</p>
<p class="E"><span class="Q">WriteLine </span>writes a single raster line to the output RasterEncoder - in this case,<span class="Q"> JPGEncode</span>r.</p>
<p class="E">&nbsp;</p>
<hr><p id="6" class="D">6. Image cache</p>
<p class="E">Image cache can significantly speed up GUI when Images are generated based on the set of parameters and the same set o parameters repeats often.</p>
<p class="E">&nbsp;</p>
<p class="H"><span class="I">#include</span><span class="J"> </span>&lt;<span class="J">CtrlLib</span>/<span class="J">CtrlLib</span>.<span class="J">h</span>&gt;</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">using</span> <span class="L">namespace</span> Upp;</p>
<p class="K">&nbsp;</p>
<p class="K">Image CreateBall(<span class="L">int</span> r, Color color)</p>
<p class="K">{</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">int</span> rr <span class="O">=</span> <span class="P">2</span> <span class="O">*</span> r;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">int</span> r2 <span class="O">=</span> r <span class="O">*</span> r;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;ImageBuffer b(rr, rr);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">for</span>(<span class="L">int</span> y <span class="O">=</span> <span class="P">0</span>; y <span class="O">&lt;</span> rr; y<span class="O">++</span>)</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">for</span>(<span class="L">int</span> x <span class="O">=</span> <span class="P">0</span>; x <span class="O">&lt;</span> rr; x<span class="O">++</span>) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RGBA<span class="O">&amp;</span> a <span class="O">=</span> b<span class="O">[</span>y<span class="O">][</span>x<span class="O">]</span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a<span class="O">.</span>r <span class="O">=</span> color<span class="O">.</span>GetR();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a<span class="O">.</span>g <span class="O">=</span> color<span class="O">.</span>GetG();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a<span class="O">.</span>b <span class="O">=</span> color<span class="O">.</span>GetB();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">int</span> q <span class="O">=</span> ((x <span class="O">-</span> r) <span class="O">*</span> (x <span class="O">-</span> r) <span class="O">+</span> (y <span class="O">-</span> r) <span class="O">*</span> (y <span class="O">-</span> r)) <span class="O">*</span> <span class="P">256</span> <span class="O">/</span> r2;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a<span class="O">.</span>a <span class="O">=</span> q <span class="O">&lt;=</span> <span class="P">255</span> <span class="O">?</span> q <span class="O">:</span> <span class="P">0</span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="U"><u>return</u></span> Image(b);</p>
<p class="K">}</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">struct</span> BallMaker <span class="O">:</span> <span class="Q"><u>ImageMaker</u></span> {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;Color color;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">int</span> &nbsp;&nbsp;r;</p>
<p class="K">&nbsp;</p>
<p class="M"><span class="V"> &nbsp;&nbsp;&nbsp;</span><u>String Key()</u><span class="V"><u> </u></span><span class="O"><u>const</u></span><span class="V"><u> </u></span><span class="O"><u>override</u></span><u> {</u></p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">char</span> h<span class="O">[</span><span class="L">sizeof</span>(<span class="L">int</span>) <span class="O">+</span> <span class="P">3</span><span class="O">]</span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="O">*</span>(<span class="L">int</span> <span class="O">*</span>)h <span class="O">=</span> r;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h<span class="O">[</span><span class="L">sizeof</span>(<span class="L">int</span>)<span class="O">]</span> <span class="O">=</span> color<span class="O">.</span>GetR();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h<span class="O">[</span><span class="L">sizeof</span>(<span class="L">int</span>) <span class="O">+</span> <span class="P">1</span><span class="O">]</span> <span class="O">=</span> color<span class="O">.</span>GetG();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h<span class="O">[</span><span class="L">sizeof</span>(<span class="L">int</span>) <span class="O">+</span> <span class="P">2</span><span class="O">]</span> <span class="O">=</span> color<span class="O">.</span>GetB();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="U"><u>return</u></span> String(h, <span class="L">sizeof</span>(<span class="L">int</span>) <span class="O">+</span> <span class="P">3</span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;</p>
<p class="M"><span class="V"> &nbsp;&nbsp;&nbsp;</span><u>Image Make() </u><span class="O"><u>const</u></span><span class="V"><u> </u></span><span class="O"><u>override</u></span><u> {</u></p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="U"><u>return</u></span> CreateBall(r, color);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K">};</p>
<p class="K">&nbsp;</p>
<p class="K">Image CreateBallCached(<span class="L">int</span> r, Color color)</p>
<p class="K">{</p>
<p class="K"> &nbsp;&nbsp;&nbsp;BallMaker m;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;m<span class="O">.</span>r <span class="O">=</span> r;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;m<span class="O">.</span>color <span class="O">=</span> color;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="U"><u>return</u></span> <span class="Q"><u>MakeImage</u></span>(m);</p>
<p class="K">}</p>
<p class="K">&nbsp;</p>
<p class="K"><span class="L">struct</span> MyApp <span class="O">:</span> <span class="L">public</span> TopWindow {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">bool</span> cached;</p>
<p class="K">&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">void</span> Paint(Draw<span class="O">&amp;</span> w) <span class="L">override</span> {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawRect(GetSize(), White);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">for</span>(<span class="L">int</span> y <span class="O">=</span> <span class="P">0</span>; y <span class="O">&lt;</span> <span class="P">300</span>; y <span class="O">+=</span> <span class="P">30</span>)</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="L">for</span>(<span class="L">int</span> i <span class="O">=</span> <span class="P">10</span>; i <span class="O">&lt;</span> <span class="P">500</span>; i <span class="O">+=</span> i <span class="O">/</span> <span class="P">3</span>) {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Color c <span class="O">=</span> Color((<span class="P">200</span> <span class="O">*</span> i) <span class="O">&amp;</span> <span class="P">255</span>, (<span class="P">150</span> <span class="O">*</span> i) <span class="O">&amp;</span> <span class="P">255</span>, (<span class="P">300</span> <span class="O">*</span> i) <span class="O">&amp;</span> <span class="P">255</span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w<span class="O">.</span>DrawImage(i, y <span class="O">+</span> i <span class="O">/</span> <span class="P">5</span>, (cached <span class="O">?</span> CreateBallCached <span class="O">:</span> CreateBall)(i <span class="O">/</span> <span class="P">2</span>, c));</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K">&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;<span class="L">void</span> LeftDown(Point, <span class="R">dword</span>) <span class="L">override</span> {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cached <span class="O">=</span> <span class="L">true</span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Title(<span class="P">&quot;Now cached - try to resize the window to see the speed&quot;</span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K">&nbsp;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyApp() {</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cached <span class="O">=</span> <span class="L">false</span>;</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Title(<span class="P">&quot;Not cached - try to resize the window to see the speed, click to activate the cache&quot;</span>);</p>
<p class="K"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sizeable()<span class="O">.</span>Zoomable();</p>
<p class="K"> &nbsp;&nbsp;&nbsp;}</p>
<p class="K">};</p>
<p class="K">&nbsp;</p>
<p class="K">GUI_APP_MAIN</p>
<p class="K">{</p>
<p class="K"> &nbsp;&nbsp;&nbsp;MyApp()<span class="O">.</span>Run();</p>
<p class="K">}</p>
<p class="E">&nbsp;</p>
<p class="E">In this example, CreateBall routine creates the Image and takes the time to do so. Anyway, in the Paint, the same resulting Image is needed many times.</p>
<p class="E">Therefore this situation is a good candidate for Image caching. To cache the CreateBall results, you need to create a class derived from <span class="Q">ImageMaker</span>. <span class="Q">Key</span> virtual method must generate unique String based on required set of parameters, which should be contained as class members. <span class="Q">Make</span> method then creates actual Image based on these parameters.</p>
<p class="E"><span class="Q">MakeImage </span>function then scans the image cache for the image based on Key result (it uses RTTI to tell apart various ImageMakers). If the required image is not in the cache yet, it is created using Make and cached.</p>
<p class="E">The maximum cache size adjusts dynamically with platform specific maximum (4MB for Win32).</p>
<p class="E">&nbsp;</p>
<p class="F"><a href="srcdoc$Draw$ImgTutorial_en-us.html_8.png"><img src="srcdoc$Draw$ImgTutorial_en-us.html_8.png" border="0" alt="" style="width: 551px; height: 494px"></a></p>
<p class="E">&nbsp;</p>
<hr><p class="D">Recommended tutorials:</p>
<p class="E">If you want to learn more, we have several tutorials that you can find useful:</p>
<p class="W"><a href="srcdoc$Draw$DrawTutorial$en-us.html">Draw tutorial </a>- in this tutorial we show more advance techniques of drawing inside window. This is the natural continue of things mention on this page.</p>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
<TABLE BORDER="0" WIDTH="100%"><TR><TD></TD>
</TR>
</TABLE>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0" BGCOLOR="#FFFFFF" WIDTH="100%" style="border-style: solid; border-width: 1px; border-color: #6E89AE;padding: 10px;;"><TR><TD><TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0" WIDTH="100%"><TR><TD><p class="A"><span class="B"> </span><a href="www$uppweb$contribweb$en-us.html">Do you want to contribute?</a></p>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
</TD>
</TR>
</TABLE>
<script type="text/javascript">var a={};var p=window.location.pathname.split("/");p=p[p.length-1];var s='<select id="lang" onchange="window.location=document.getElementById(\'lang\').value;">';for(l in a){if(p==l){d=" selected=1"}else{d=""}s+='<option value="'+l+'"'+d+'>'+a[l]+'</option>'}s+='</select>';var d=document.createElement('div');d.innerHTML=s;var c=document.getElementById('langs');c.replaceChild(d,c.firstChild);document.getElementById('langbox').style.display='block';</script></BODY>
